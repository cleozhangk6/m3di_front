{% load static %}


<!DOCTYPE html>

<html>
  <head> 
      <title>M3DI | Results</title>
      <!--Font Awesome kit's code-->
      <script src="https://kit.fontawesome.com/777bbb3675.js" crossorigin="anonymous"></script>
      <!--Link CSS stylesheet-->
      <link rel="stylesheet" href="{% static 'basic/styles.css' %}" />
      <script src="{% static 'basic/cytoscape.js' %}"></script>
  </head>

  <body>

    <div id="stick-to-top">
      <div class="top_bar">
        <div class="container"></div>
      </div>
      <header class="main-header">
        <div class="container">
          <a id="m3di_logo_left" href="{% url 'basic:index' %}">
            <img src="{% static 'basic/images/logo.png' %}" width="100"></a>
          <nav class="nav main-nav">            
            <ul>
              <li><a href="{% url 'basic:index' %}">Home</a></li>
              <li><a href="about.html">About</a></li>
              <li><a href="dataset.html">Dataset</a></li>
              <li><a href="contact.html">Contact us</a></li>
            </ul>
          </nav>
        </div>      
      </header>
      <div class="search-bar">
          <div class="container">
            <form action="{% url 'basic:main' %}" method="get">
                Uniprot/Gene ID:
                <input id="input_uni" name="q" type="text" placeholder="" size="10px">
                Residue Position:
                <input id="input_var" name="v" type="text" placeholder="" size="6px">
                <!-- Mutation:
                <input id="input_wt" name="wt" type="text" placeholder="" size="4px">
                <i class="fa-solid fa-arrow-right"></i>
                <input id="input_mut" name="mut" type="text" placeholder="" size="4px"> -->
                <a href="{% url 'basic:main' %}">
                  <button type="submit">Submit</button></a>
            </form>
          </div>
    </div>
    </div>
    
    <section class="results">
      <p><strong>Search Results</strong></p>
      {% if query_uni and query_var %}
      <p>You searched for {{ query_uni }}</p>
      <p>Variant position {{ query_var }}</p>
      </p>
      
      {% elif query_uni %}
      <p>You searched for {{ query_uni }}</p>
      <p>No variant specified</p>

      {% else %}
      <p>No search submitted</p>
      
      {% endif %}
        
      <div class="container">

        <h3>Interaction</h3>
        <div id="cy"></div>
        {{ results_interact_string|json_script:"interaction-data" }}

        {% comment %} <h3>Interactome3d</h3>
        {%for object in results_interactome3d %}
          {%if object.prot1 == query_uni%}
          <p>{{object.type}} available for PDB complex: 
            <a href='https://www.rcsb.org/structure/{{ object.pdb_id }}'>{{ object.pdb_id }}</a>({{object.prot1}}/{{object.prot2}})</p>
          {%elif object.prot2 == query_uni%}
          <p>{{object.type}} available for PDB complex: 
            <a href='https://www.rcsb.org/structure/{{ object.pdb_id }}'>{{ object.pdb_id }}</a> ({{object.prot2}}/{{object.prot1}})</p>
          {%endif%}
        {%endfor%} {% endcomment %}

        <h3>Basic Info</h3>
        {% for object in results_basic %}
          <ul>
            <li>Protein name: <a href="{{ object.protein_link }}">{{ object.protein_name }}</a></li>
            <li>Gene name: <a href="{{ object.gene_link }}">{{ object.gene_name }}</a></li>
          </ul>
          {% endfor %}

          <h3>Signal Peptide</h3>
          {% for object in results_signal %}
          <ul>
            {%if results_signal.pos == 'true' %}
            <p>The variant is in the signal peptide- position {{results_signal.pos}}</p>
            {% else%}
            <p>The variant is not in the signal peptide</p>
            {%endif%}

          </ul>
          {% endfor %}

          <h3>Transmembrane Domain</h3>
          {% for object in results_transmem %}
            <p>The variant is in a transmembrane domain. The domain range is from {{objects.tm_end}}</p>
            {%empty%}
            <p>Not in domain</p>
          <ul>


          </ul>
          {% endfor %}

        <h3>Variants</h3>
          <table class="variant-table">
            <tr>
              <th>UniprotID</th>
              <th>Position</th>
              <th>Wildtype</th>
              <th>Mutant</th>
              <th>Prediction</th>
              <th>Reason</th>
            </tr>
            {% for object in results_variant %}
            <tr>
              <td>{{ object.uniprot }}</td>
              <td>{{ object.pdbpos }}</td>
              <td>{{ object.res_wt }}</td>
              <td>{{ object.res_mut }}</td>
              <td>{{ object.missensepred }}</td>
              <td>{{ object.missense_reason }}</td>
            </tr>
          {% endfor %}
          </table>
              
        
        <h3>Topology</h3>
        {% for object in results_topo %}
          <ul>
            <li>Variant {{ query_var }} is located at the {{ object.topology }} region</li>
          </ul>
        {% endfor %}


      </div>

          <br/>
          <br>
    </section>
    
    <hr color="#CAC4D7">
    


    <footer>
      <div class="container">
        <span id="msc_left">MSc Bioinformatics and Systems Biology</span>
        <img id="ic_logo_right" src="{% static 'basic/images/Imperial.png' %}" width="200">
      </div>
    </footer>



    <script src="{% static 'basic/scripts.js' %}"></script>
    <script>
      var coll = document.getElementsByClassName("collapsible");
      var i;
      
      for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function() {
          this.classList.toggle("active");
          var content = this.nextElementSibling;
          if (content.style.display === "block") {
            content.style.display = "none";
          } else {
            content.style.display = "block";
          }
        });
      }
      </script>

  </body>
</html>
